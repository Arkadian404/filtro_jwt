<section class="bread-crumb">
  <div class="container">
    <div class="bread-crumb-title text-center">
      {{title | uppercase}}
    </div>
    <nav aria-label="breadcrumb">
      <ol class="breadcrumb justify-content-center">
        <li class="breadcrumb-item"><a [routerLink]="'/home'">Trang ch·ªß</a></li>
        <li class="breadcrumb-item active" aria-current="page"><strong>{{title}}</strong> </li>
      </ol>
    </nav>
  </div>
</section>
<section class="main">
  <div class="container mt-5">
    <div class="row">
      <div class="col-lg-3 col-md-12 col-sm-12 col-12">
        <div class="sidebar">
          <aside class="aside-item collection-category d-none d-lg-block">
            <div class="aside-title">Danh m·ª•c</div>
            <div class="aside-content">
              <ul>
                <li><a [routerLink]="'/collection/instant-coffee'" routerLinkActive="active-link">C√† ph√™ b·ªôt</a></li>
                <li><a [routerLink]="'/collection/roasted-bean-coffee'" routerLinkActive="active-link">C√† ph√™ h·∫°t ƒë√£ rang</a></li>
                <li><a [routerLink]="'/collection/coffee-ball'" routerLinkActive="active-link">C√† ph√™ h·∫°t n√©n</a></li>
                <li><a [routerLink]="'/collection/bottled-coffee'" routerLinkActive="active-link">C√† ph√™ ƒë√≥ng chai</a></li>
                <li><a [routerLink]="'/collection/americas-coffee'" routerLinkActive="active-link">C√°c n∆∞·ªõc ch√¢u M·ªπ</a></li>
                <li><a [routerLink]="'/collection/africa-coffee'" routerLinkActive="active-link">C√°c n∆∞·ªõc ch√¢u Phi</a></li>
                <li><a [routerLink]="'/collection/asia-coffee'" routerLinkActive="active-link">C√°c n∆∞·ªõc ch√¢u √Å</a></li>
                <li><a [routerLink]="'/collection/limited-coffee'" routerLinkActive="active-link">C√† ph√™ qu√Ω hi·∫øm (limited)</a></li>
                <li><a [routerLink]="'/collection/special-coffee'" routerLinkActive="active-link">H·ªôp qu√† t·∫∑ng (special box)</a></li>
                <li><a [routerLink]="'/collection/best-seller'" routerLinkActive="active-link">S·∫£n ph·∫©m b√°n ch·∫°y</a></li>
              </ul>
            </div>
          </aside>
          <div class="aside-filter">
            <div class="aside-title">
              L·ªçc s·∫£n ph·∫©m
            </div>
            <div class="filter-container">
              <aside class="filter-type">
                <div class="d-flex justify-content-between align-items-end">
                  <div class="aside-top-title">Th∆∞∆°ng hi·ªáu</div>
                  <button (click)="isBrandClose = !isBrandClose"   mat-icon-button type="button" data-bs-toggle="collapse" data-bs-target="#coffeeBrand" aria-expanded="false" aria-controls="coffeeBrand">
                    <ng-container *ngIf="isBrandClose;else isBrandOpen">
                      <mat-icon fontIcon="add"></mat-icon>
                    </ng-container>
                    <ng-template #isBrandOpen>
                      <mat-icon fontIcon="remove"></mat-icon>
                    </ng-template>
                  </button>
                </div>
                <div class="filter-group collapse" id="coffeeBrand">
                  <ul class="filter">
                    <li *ngFor="let b of brands">
                      <mat-checkbox (change)="onBrandChange($event)" color="accent" [value]="b.name">
                        {{b.name}}
                      </mat-checkbox>
                    </li>
                  </ul>
                </div>
              </aside>
              <aside class="filter-type mt-3">
                <div class="d-flex justify-content-between align-items-end">
                  <div class="aside-top-title">Lo·∫°i c√† ph√™</div>
                  <button mat-icon-button (click)="isCategoryClose = !isCategoryClose" type="button" data-bs-toggle="collapse" data-bs-target="#coffeeType" aria-expanded="false" aria-controls="coffeeType">
                    <ng-container *ngIf="isCategoryClose;else isCategoryOpen">
                      <mat-icon fontIcon="add"></mat-icon>
                    </ng-container>
                    <ng-template #isCategoryOpen>
                      <mat-icon fontIcon="remove"></mat-icon>
                    </ng-template>
                  </button>
                </div>
                <div class="filter-group collapse" id="coffeeType">
                  <ul class="filter">
                    <li *ngFor="let c of categories">
                      <mat-checkbox (change)="onCategoryChange($event)" color="accent" [value]="c.name">
                        {{c.name}}
                      </mat-checkbox>
                    </li>
                  </ul>
                </div>
              </aside>
              <aside class="filter-type mt-3">
                <div class="d-flex justify-content-between align-items-end">
                  <div class="aside-top-title">H∆∞∆°ng v·ªã</div>
                  <button mat-icon-button (click)="isFlavorClose = !isFlavorClose" type="button" data-bs-toggle="collapse" data-bs-target="#coffeeFlavor" aria-expanded="false" aria-controls="coffeeFlavor">
                    <ng-container *ngIf="isFlavorClose;else isFlavorOpen">
                      <mat-icon fontIcon="add"></mat-icon>
                    </ng-container>
                    <ng-template #isFlavorOpen>
                      <mat-icon fontIcon="remove"></mat-icon>
                    </ng-template>
                  </button>
                </div>
                <div class="filter-group collapse" id="coffeeFlavor">
                  <ul class="filter">
                    <li *ngFor="let f of flavors">
                      <mat-checkbox (change)="onFlavorChange($event)" color="accent" [value]="f.name">
                        {{f.name}}
                      </mat-checkbox>
                    </li>
                  </ul>
                </div>
              </aside>
              <aside class="filter-type mt-3">
                <div class="d-flex justify-content-between align-items-end">
                  <div class="aside-top-title">Xu·∫•t x·ª©</div>
                  <button mat-icon-button (click)="isOriginClose = !isOriginClose" type="button" data-bs-toggle="collapse" data-bs-target="#coffeeOrigin" aria-expanded="false" aria-controls="coffeeOrigin">
                    <ng-container *ngIf="isOriginClose;else isOriginOpen">
                      <mat-icon fontIcon="add"></mat-icon>
                    </ng-container>
                    <ng-template #isOriginOpen>
                      <mat-icon fontIcon="remove"></mat-icon>
                    </ng-template>
                  </button>
                </div>
                <div class="filter-group collapse" id="coffeeOrigin">
                  <ul class="filter">
                    <li *ngFor="let o of origins">
                      <mat-checkbox (change)="onOriginChange($event)" color="accent" [value]="o.name">
                        {{o.name}}
                      </mat-checkbox>
                    </li>
                  </ul>
                </div>
              </aside>
              <aside class="filter-type mt-3">
                <div class="d-flex justify-content-between align-items-end">
                  <div class="aside-top-title">Nh√† cung c·∫•p</div>
                  <button mat-icon-button (click)="isVendorClose = ! isVendorClose" type="button" data-bs-toggle="collapse" data-bs-target="#coffeeVendor" aria-expanded="false" aria-controls="coffeeVendor">
                    <ng-container *ngIf="isVendorClose;else isVendorOpen">
                      <mat-icon fontIcon="add"></mat-icon>
                    </ng-container>
                    <ng-template #isVendorOpen>
                      <mat-icon fontIcon="remove"></mat-icon>
                    </ng-template>
                  </button>
                </div>
                <div class="filter-group collapse" id="coffeeVendor">
                  <ul class="filter">
                    <li *ngFor="let v of vendors">
                      <mat-checkbox (change)="onVendorChange($event)" color="accent" [value]="v.name">
                        {{v.name}}
                      </mat-checkbox>
                    </li>
                  </ul>
                </div>
              </aside>
            </div>
          </div>
        </div>
      </div>
      <section class="collection col-lg-9 col-md-12 col-sm-12 col-12">
        <div class="category-products">
          <div class="sort-category">
            <div class="sort-left">
              <h3 class="sort-title">
                <svg
                  style="width: 15px;
                      height: 15px;
                      vertical-align: middle;"
                  viewBox="0 0 20 20" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" fill="#000000">
                  <g id="SVGRepo_bgCarrier" stroke-width="0"></g>
                  <g id="SVGRepo_tracerCarrier" stroke-linecap="round" stroke-linejoin="round"></g>
                  <g id="SVGRepo_iconCarrier"> <!-- Uploaded to: SVG Repo, www.svgrepo.com, Generator: SVG Repo Mixer Tools -->
                    <title>ic_fluent_text_sort_ascending_20_filled</title>
                    <desc>Created with Sketch.</desc>
                    <g id="üîç-System-Icons" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd">
                      <g id="ic_fluent_text_sort_ascending_20_filled" fill="#212121" fill-rule="nonzero">
                        <path d="M8,11 C8.2821,11 8.54033,11.1583 8.66834,11.4097 C8.79635,11.661 8.77247,11.963 8.60656,12.1911 L5.47283,16.5 L8,16.5 C8.41422,16.5 8.75,16.8358 8.75,17.25 C8.75,17.6642 8.41422,18 8,18 L4,18 C3.71791,18 3.45967,17.8417 3.33167,17.5903 C3.20366,17.339 3.22753,17.037 3.39345,16.8089 L6.52718,12.5 L4,12.5 C3.58579,12.5 3.25,12.1642 3.25,11.75 C3.25,11.3358 3.58579,11 4,11 L8,11 Z M13.5000006,2 C13.9142,2 14.25,2.33579 14.25,2.75 L14.25,15.5241 L16.7383,13.2017 C17.0411,12.9191 17.5157,12.9355 17.7983,13.2383 C18.0809,13.5411 18.0646,14.0157 17.7617,14.2983 L14.0117,17.7983 C13.7236,18.0672 13.2764,18.0672 12.9883,17.7983 L9.23826,14.2983 C8.93545,14.0157 8.91909,13.5411 9.20171,13.2383 C9.48434,12.9355 9.95893,12.9191 10.2617,13.2017 L12.75,15.5241 L12.75,2.75 C12.75,2.33579 13.0858,2 13.5000006,2 Z M6.00002,2 C6.31967,2 6.6042,2.2026 6.70876,2.50467 L8.95876,9.00467 C9.09425,9.39609 8.88678,9.82325 8.49535,9.95874 C8.10393,10.0942 7.67677,9.88676 7.54128,9.49533 L7.19674,8.5 L4.8033,8.5 L4.45876,9.49533 C4.32327,9.88676 3.89611,10.0942 3.50469,9.95874 C3.11326,9.82325 2.90579,9.39609 3.04128,9.00467 L5.29128,2.50467 C5.39584,2.2026 5.68037,2 6.00002,2 Z M6.00002,5.0428 L5.32253,7 L6.67751,7 L6.00002,5.0428 Z" id="üé®-Color">
                        </path>
                      </g>
                    </g>
                  </g>
                </svg>
                <span>S·∫ÆP X·∫æP</span>
              </h3>
              <div class="sort-item">
                <div class="sort-part">
                  <mat-radio-group (change)="onRadioChange($event)">
                    <mat-radio-button color="primary" class="radio-input" value="product_name_asc">T√™n A-Z </mat-radio-button>
                    <mat-radio-button color="primary" class="radio-input" value="product_name_desc">T√™n Z-A</mat-radio-button>
                    <mat-radio-button color="primary" class="radio-input" value="price_asc">Gi√° tƒÉng d·∫ßn</mat-radio-button>
                    <mat-radio-button color="primary" class="radio-input" value="price_desc">Gi√° gi·∫£m d·∫ßn</mat-radio-button>
                  </mat-radio-group>
                </div>
              </div>
            </div>
          </div>
          <div class="d-flex justify-content-center mt-5" *ngIf="isLoading">
            <mat-spinner color="primary"></mat-spinner>
          </div>
          <ng-container class="d-flex justify-content-center mt-5" *ngIf="isError && !isLoading">
            <div class="alert alert-warning" role="warning">
              <h3 class="text-center">Kh√¥ng t√¨m th·∫•y s·∫£n ph·∫©m</h3>
            </div>
          </ng-container>
          <ng-container *ngIf="!isLoading && !isError">
            <section class="row products-view">
              <div *ngFor="let p of products; let i = index" class="col-md-3 col-lg-3 col-sm-6 col-6">
                <div class="block-item">
                  <form [formGroup]="wishlistItemForm" (ngSubmit)="handleWishlist(p)">
                    <button type="submit" class="btn-wishlist">
                      <mat-icon *ngIf="checkExist(isWishlist, p); else unFavorite" class="active-wishlist" fontIcon="favorite"></mat-icon>
                      <ng-template #unFavorite>
                        <mat-icon fontIcon="favorite_border"></mat-icon>
                      </ng-template>
                    </button>
                  </form>
                  <form [formGroup]="form" (ngSubmit)="addToCart(p)">
                    <a [routerLink]="['/product', p.slug]" class="product-transition">
                      <img [src]="p.images[0].url" [alt]="p.name">
                    </a>
                    <div class="product-info">
                      <a [routerLink]="['/product', p.slug]" class="product-name">{{p.name}}</a>
                      <div class="review-badge">
                        <div class="review-star">
                          <ng-container *ngIf="p.rating > 0; else starsOff">
                            <i *ngFor="let star of calcStars(p.rating)" class="fas fa-star text-warning star-off"></i>
                            <i *ngFor="let star of calcStars(5-p.rating)" class="far fa-star text-warning star-off"></i>
                          </ng-container>
                          <ng-template #starsOff>
                            <ng-container *ngIf="p.rating > 0; else starsOff">
                              <i *ngFor="let star of calcStars(p.rating)" class="fas fa-star text-warning star-off"></i>
                              <i *ngFor="let star of calcStars(5-p.rating)" class="far fa-star text-warning star-off"></i>
                            </ng-container>
                            <ng-template #starsOff>
                              <i class="far fa-star text-warning star-off"></i>
                              <i class="far fa-star text-warning star-off"></i>
                              <i class="far fa-star text-warning star-off"></i>
                              <i class="far fa-star text-warning star-off"></i>
                              <i class="far fa-star text-warning star-off"></i>
                            </ng-template>
                          </ng-template>
                        </div>
                      </div>
                      <div class="product-price mt-2">
                        <span class="price">{{p.productDetails[0].price | currencyVND}}</span>
                        <span class="old-price">{{p.productDetails[0].price*1.5 | currencyVND}}</span>
                      </div>
                    </div>
                    <button class="add-button" type="submit">Th√™m v√†o gi·ªè</button>
                  </form>
                </div>
              </div>
            </section>
            <div class="row">
              <div class="col-lg-12 col-sm-12 mt-4">
                <nav aria-label="Page navigation example">
                  <ul class="pagination pagination-flush justify-content-center">
                    <li class="page-item" [ngClass]="{disabled : number<=0}">
                      <a  class="page-tag" [routerLink]="" (click)="goToPreviousPage()"><<</a>
                    </li>
                    <ng-container *ngFor="let n of totalPages">
                      <li class="page-item" [ngClass]="{activated: n-1 == number }">
<!--                        <a class="page-tag" [routerLink]="['/collection/all']" [queryParams]="{page: n-1, sort:sort, flavor: flavor}">-->
<!--                          <span>{{n}}</span>-->
<!--                        </a>-->
                        <a class="page-tag" [routerLink]="" (click)="onTagChange(n-1)">
                          <span>{{n}}</span>
                        </a>
                      </li>
                    </ng-container>
                    <li class="page-item" [ngClass]="{disabled : number>=totalPages.length-1}">
                      <a class="page-tag" [routerLink]="" (click)="goToNextPage()" tabindex="-1" aria-disabled="true">
                        >>
                      </a>
                    </li>
                  </ul>
                </nav>
              </div>
            </div>
          </ng-container>
        </div>
      </section>
    </div>
  </div>
</section>

